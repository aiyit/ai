<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Web3D 색상 선택</title>
  <script src="http://code.jquery.com/jquery-1.7.2.js"></script>
  <script src="http://www.x3dom.org/x3dom/release/x3dom.js"></script>
  <link rel="stylesheet" href="http://www.x3dom.org/x3dom/release/x3dom.css"/>
  <style>
    #guide { text-align: center; }
  </style>
  <script>
    function handleClick(event) {
      var r = event.hitPnt[0];
      var g = event.hitPnt[1];
      var b = event.hitPnt[2];

      document.getElementById("Rcolor").innerHTML = r.toFixed(0);
      document.getElementById("Gcolor").innerHTML = g.toFixed(0);
      document.getElementById("Bcolor").innerHTML = b.toFixed(0);

      var rc = (r / 255).toFixed(2);
      var gc = (g / 255).toFixed(2);
      var bc = (b / 255).toFixed(2);

      document.getElementById('target').setAttribute('diffuseColor', `${rc} ${gc} ${bc}`);
    }
  </script>
</head>
<body>
<h3 style="text-align:center;">Object Change Color</h3>

<div id="guide">
  <table style="border:1px solid black; width:200px; margin: 0 auto;">
    <tr><td>R:</td><td id="Rcolor"></td></tr>
    <tr><td>G:</td><td id="Gcolor"></td></tr>
    <tr><td>B:</td><td id="Bcolor"></td></tr>
  </table>
</div>

<x3d width="100%" height="400px" vrmode="true" stereo="true" eyeSeparation="0.2" showStat="false" showLog="false">
  <scene pickMode="color">
    <viewpoint position="0 2 15" orientation="0 1 0 0" fieldOfView="1.2" description="전체 보기"></viewpoint>

    <!-- 색상 선택 판 -->
    <transform translation="0 -2 0">
      <shape onclick="handleClick(event)">
        <indexedFaceSet coordIndex="0 1 2 3 -1" solid="false">
          <coordinate point="-2 0 0, 2 0 0, 2 4 0, -2 4 0"></coordinate>
          <color color="255 0 0, 0 255 0, 0 0 255, 255 255 0"></color>
        </indexedFaceSet>
      </shape>
    </transform>

    <!-- 색상 변경 대상 -->
    <transform translation="-5 0 0">
      <shape>
        <sphere></sphere>
        <appearance>
          <material id="target" diffuseColor="1 0 0"></material>
        </appearance>
      </shape>
    </transform>
  </scene>
</x3d>
</body>
</html>
